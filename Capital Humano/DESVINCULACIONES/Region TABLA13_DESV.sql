SELECT 'INDICADOR' DESCRIPCION,'UM' UM, 'PB' PB,C002 mes1, C004 Mes2, C006 mes3, null orden
 FROM APEX_collections
 WHERE collection_name = 'DESVINCULACION_MES'
GROUP BY C002,C004,C006
UNION ALL
SELECT 'DESVINCULACION TOTAL' DESCRIPCION, NULL UM, PB PB,-- TO_CHAR(ANHO_TOT) PB, 
MES1, MES2, MES3,3
FROM
    (SELECT  
     TO_CHAR(sum(C001))mes1, TO_CHAR(sum(C003)) Mes2, TO_CHAR(sum(C005)) mes3,  TO_CHAR(sum(C013))PB
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MES'
       AND DECODE(C008,NULL,'X',C008) <> 'Judicial')A,
       (SELECT trunc(count(*)/12) ANHO_TOT
      FROM CUBO_EMPLEADO_V_DESV
     WHERE EMPL_EMPRESA = 1
       AND TO_CHAR(EMPL_FEC_SALIDA, 'YYYY') = '2017') B
UNION ALL
SELECT  'DESVINCULACION CONTRATO INDEFINIDO' DESCRIPCION,'Q' UM,   TO_CHAR(sum(C013)) PB,
     TO_CHAR(sum(C001))mes1, TO_CHAR(sum(C003)) Mes2, TO_CHAR(sum(C005)) mes3,3
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MES'
       AND DECODE(C008,NULL,'X',C008)<> 'Judicial'
       AND C010 ='I'
UNION ALL
SELECT  'DESVINCULACIONES CONTRATO TEMPORAL' DESCRIPCION, NULL UM, TO_CHAR(sum(C013)) PB,
     TO_CHAR(sum(C001))mes1, TO_CHAR(sum(C003)) Mes2, TO_CHAR(sum(C005)) mes3,3
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MES'
       AND C008<> 'Judicial'
       AND C010 ='T'
UNION ALL
SELECT C008 DESCRIPCION, 'Q' UM,  TO_CHAR(sum(C013)) PB,
     TO_CHAR(sum(C001))mes1, TO_CHAR(sum(C003)) Mes2, TO_CHAR(sum(C005)) mes3,3
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MES'
     AND C008 <> 'Judicial'
       AND C010 <>'T' 
       GROUP BY C008
UNION ALL
SELECT C008 DESCRIPCION, 'Q' UM,  C013 PB,
     C001 mes1, C003 Mes2, C005 mes3,4
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MES'
     AND C008 = 'Judicial'
UNION ALL
SELECT 'COSTO DE LIQUIDACION FINAL' DESCRIPCION, 'Gs.' UM,  TO_CHAR(sum(C007),'999G999G999G999G999') PB,
     TO_CHAR(sum(C001),'999G999G999G999G999')mes1, TO_CHAR(sum(C003),'999G999G999G999G999') Mes2, TO_CHAR(sum(C005),'999G999G999G999G999') mes3,5
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_MONTO'
UNION ALL
SELECT 'Prevision Imnder.-Pre Aviso' DESCRIPCION,
       'Gs.' UM,
       NULL PB,
       TO_CHAR(ROUND(SUM(T.PGTO_IMPORTE) / 12),'999G999G999G999G999') MES1,
       TO_CHAR(ROUND(SUM(T.PGTO_IMPORTE) / 12),'999G999G999G999G999') MES2,
       TO_CHAR(ROUND(SUM(T.PGTO_IMPORTE) / 12),'999G999G999G999G999') MES3,
       6 ORDEN
  FROM FAC_LONDON_PRES_GASTO_AN_V T
 WHERE T.PGTO_ANHO = 2022
    AND T.pgto_empr =:P_EMPRESA
   AND UPPER(T.CTAC_DESC) LIKE '%INDEM%'

/*     
UNION ALL     
SELECT 'GRATIFICACIONES' DESCRIPCION, 'Gs.' UM, TO_CHAR(sum(C007),'999G999G999G999G999') PB,
     TO_CHAR(sum(C001),'999G999G999G999G999')mes1, TO_CHAR(sum(C003),'999G999G999G999G999') Mes2, TO_CHAR(sum(C005),'999G999G999G999G999') mes3,6
     FROM APEX_collections
     WHERE collection_name = 'DESVINCULACION_GRAT'*/
          

